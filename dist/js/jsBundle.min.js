!function(){"use strict";function t(t,e,n,o){t.state("Home",{url:"/",templateUrl:"/templates/home.html",controller:"HomeController as vm"}).state("Welcome",{url:"/welcome",templateUrl:"/templates/welcome.html",controller:"WelcomeController as vm"}).state("About",{url:"/about",templateUrl:"/templates/about.html"}).state("Candidate",{url:"/candidate/:id",templateUrl:"/templates/candidate.html",controller:"CandidateController as vm"}).state("Reg",{url:"/reg",templateUrl:"/templates/testreg.html"}).state("Log",{url:"/login",templateUrl:"/templates/testlogin.html"}).state("Contact",{url:"/contact",templateUrl:"/templates/contact.html",controller:"ContactFormController as vm"}).state("PasswordReset",{url:"/passwordReset",templateUrl:"/templates/passwordReset.html",controller:"PasswordResetController as vm"}).state("ContactMessageConfirmation",{url:"/contactMessageConfirmation",templateUrl:"/templates/contactMessageConfirmation.html"}).state("PasswordResetConfirmation",{url:"/passwordResetConfirmation",templateUrl:"/templates/passwordResetConfirmation.html"}).state("Stripe",{url:"/stripe",templateUrl:"/templates/stripe.html",controller:"StripeController as vm"}),e.otherwise("/"),n.caseInsensitive(!0),n.strictMode(!1),o.html5Mode(!0),Stripe.setPublishableKey("pk_test_bI1AnQTe8bcz1Wxfh2Hls1SS")}t.$inject=["$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider","$locationProvider"],angular.module("app",["ui.router","stripe","ui.bootstrap","ng-currency"]).config(t)}(),angular.module("stripe",[]).directive("stripeForm",["$window",function(t){var e={restrict:"A"};return e.link=function(e,n,o){var a=angular.element(n);a.bind("submit",function(){var n=a.find("button");n.prop("disabled",!0),t.Stripe.createToken(a[0],function(){n.prop("disabled",!1);var t=arguments;e.$apply(function(){e.$eval(o.stripeForm).apply(e,t)})})})},e}]),function(){"use strict";function t(t,e,n,o,a,r,i,s){var l=this;l.tweets,l.timeoutHandler,l.comments,l.isEditing=!1,l.daily=!0,l.weekly=!1;var c,u=[],d=[],m=[],f=[],p=[],g=[],h=[],v=0,C={top:30,right:80,bottom:30,left:80},y=document.getElementById("vizWidth").clientWidth;l.width=y-C.right-C.left;var $=angular.element(document.querySelector("#dailyViz")),w=angular.element(document.querySelector("#weeklyViz"));window.onresize=function(){y=document.getElementById("vizWidth").clientWidth,l.width=y-C.right-C.left,l.runViz()},l.showDaily=function(){t.weeklyV="animated bounceOutRight",setTimeout(function(){l.weekly=!1,l.daily=!0,t.dailyV="animated bounceInLeft"},60)},l.showWeekly=function(){t.dailyV="animated bounceOutLeft",setTimeout(function(){l.daily=!1,l.weekly=!0,t.weeklyV="animated bounceInRight"},60)},l.runViz=function(){$.empty(),w.empty();var t=500-C.top-C.bottom,e=d3.scale.linear().domain([0,d.length-1]).range([0,l.width]),n=d3.scale.linear().domain([0,100]).range([t,0]),o=d3.svg.line().x(function(t,n){return e(n)}).y(function(t){return n(t)}),a=d3.select("#dailyViz").append("svg").attr("width",l.width+C.right+C.left).attr("height",t+C.top+C.bottom).append("g").attr("transform","translate("+C.left+","+C.top+")"),r=function(t){return d[t]},i=d3.svg.axis().scale(e).orient("bottom").ticks(d.length-1).tickFormat(r).tickSize(-t);a.append("g").attr("class","x axis").attr("transform","translate(0,"+t+")").call(i);var s=d3.svg.axis().scale(n).ticks(10).orient("left");a.append("g").attr("class","y axis").attr("transform","translate(-25,0)").call(s),a.append("path").attr("d",o(u));var c=d3.scale.linear().domain([0,f.length-1]).range([0,l.width]),m=d3.select("#weeklyViz").append("svg").attr("width",l.width+C.right+C.left).attr("height",t+C.top+C.bottom).append("g").attr("transform","translate("+C.left+","+C.top+")"),h=d3.svg.line().x(function(t,e){return c(e)}).y(function(t){return n(t)}),v=function(t){return g[t]},y=d3.svg.axis().scale(c).orient("bottom").ticks(g.length-1).tickFormat(v).tickSize(-t);m.append("g").attr("class","x axis").attr("transform","translate(0,"+t+")").call(y),m.append("g").attr("class","y axis").attr("transform","translate(-25,0)").call(s),m.append("path").attr("d",h(p))},r.getCandidateById(n.id).then(function(t){l.candidate=t,c=t.name;for(var e=t.favorRatingTotals.length-1;e>t.favorRatingTotals.length-8&&e>=0;e--)u.unshift(t.favorRatingTotals[e].percentage),d.unshift(t.favorRatingTotals[e].date),m.unshift(t.favorRatingTotals[e]);for(var n=0;n<t.favorRatingTotals.length-1;n++)if(h.push(t.favorRatingTotals[n]),v+=t.favorRatingTotals[n].percentage,7==h.length){var o={};o.percentage=v/7,o.date=h[6].date,f.push(o),p.push(o.percentage),g.push(o.date),8==g.length&&(g.shift(),p.shift(),f.shift()),h=[],v=0}l.runViz()},function(t){}),function b(){a.getCandidateTweets(c).then(function(t){l.tweets=t,l.timeoutHandler=e(b,1e3)},function(t){})}(),t.$on("$destroy",function(){angular.isDefined(l.timeoutHandler)&&(e.cancel(l.timeoutHandler),l.timeoutHandler=void 0)}),i.getAllCandidateComments(n.id).then(function(t){l.candidate=t},function(t){}),l.createComment=function(){s.status._id&&i.createComment(l.comment,n.id).then(function(t){l.candidate.comments.unshift(t),l.comment=null},function(t){})},l.deleteComment=function(t){if(s.status._id){if(s.status._id!==t.user)return void alert("You cannot delete this comment");console.log(t),i.deleteComment(t._id).then(function(e){l.candidate.comments.splice(l.candidate.comments.indexOf(t),1)},function(t){alert("could not delete comment")})}},l.showUpdate=function(t){l.isEditing=t._id,l.editedComment=angular.copy(t)},l.updateComment=function(t){return s.status._id&&s.status._id===t.user?void i.updateComment(l.editedComment,t).then(function(e){l.candidate.comments.splice(l.candidate.comments.indexOf(t),1),l.candidate.comments.unshift(l.editedComment),l.isEditing=null,l.editedComment=null},function(t){alert("could not update comment")}):void alert("You cannot update this comment")}}t.$inject=["$scope","$timeout","$stateParams","$animate","TweetFactory","CandidateFactory","CommentFactory","UserFactory"],angular.module("app").controller("CandidateController",t)}(),function(){"use strict";function t(t,e,n){var o=this;t.getAllComments(e.id).then(function(t){o.comments=t},function(t){}),o.createComment=function(){t.createComment(o.comment,e.id).then(function(t){},function(t){})}}angular.module("app").controller(t,"CommentController")}(),function(){"use strict";function t(t,e,n,o){var a=this;a.sms={},a.emailConfirm=function(){swal({title:"Confirmation:",text:"Please confirm that you want to send this message",type:"warning",showCancelButton:!0,confirmButtonColor:"#82DD51",confirmButtonText:"Yes, send it!",cancelButtonColor:"#DD6B55",cancelButtonText:"Nevermind!",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(swal("Sent!","Thank you for your email!","success"),a.sendMail()):swal("Cancelled!","Your message has not been sent","error")})},a.smsConfirm=function(){swal({title:"Confirmation:",text:"Please confirm that you want to send this text",type:"warning",showCancelButton:!0,confirmButtonColor:"#82DD51",confirmButtonText:"Yes, send it!",cancelButtonColor:"#DD6B55",cancelButtonText:"Nevermind!",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(swal("Sent!","Thank you for your text!","success"),a.sendSMS()):swal("Cancelled!","Your text has not been sent","error")})},a.sendSMS=function(){e.sendSMS(a.sms).then(function(t){a.sms.firstName="",a.sms.phoneNumber="",a.sms.message=""},function(t){})},a.sendMail=function(){var e={contactName:a.contactName,contactEmail:a.contactEmail,contactMsg:a.contactMsg};t.sendMail(e).then(function(t){},function(t){})}}t.$inject=["EmailFactory","SMSFactory","$state","$stateParams"],angular.module("app").controller("ContactFormController",t)}(),function(){"use strict";function t(t,e,n){var o=this;o.user={},o.status=t.status,o.login=function(){t.login(o.user).then(function(t){e.go("Home"),o.user.password=null,o.user.email=null})},o.logout=function(){t.removeToken(),e.go("Home")},o.openReg=function(t){var e=n.open({templateUrl:"/templates/partials/registrationModal.html",size:"md",controller:"RegisterModalController as vm"});e.result.then(function(t){console.log(t)},function(){console.log("error")})},o.openLogin=function(t){var e=n.open({templateUrl:"/templates/partials/loginModal.html",size:"md",controller:"LoginModalController as vm"});e.result.then(function(t){console.log(t)},function(){console.log("error")})}}function e(t,e,n){var o=this;o.user={},t.ok=function(){n.register(o.user).then(function(t){e.close(o.user)}),o.loading=!0},t.cancel=function(){e.dismiss("cancel")}}function n(t,e,n){var o=this;o.user={},t.ok=function(){n.login(o.user).then(function(t){e.close(o.user)}),o.loading=!0},t.cancel=function(){e.dismiss("cancel")}}t.$inject=["UserFactory","$state","$uibModal"],e.$inject=["$scope","$uibModalInstance","UserFactory"],n.$inject=["$scope","$uibModalInstance","UserFactory"],angular.module("app").controller("GlobalController",t).controller("RegisterModalController",e).controller("LoginModalController",n)}(),function(){"use strict";function t(t,e,n,o,a,r,i,s){var l=this,c=n.search();l.timeoutHandler,l.busts=!1,l.bernie,l.clinton,l.trump,l.rubio,i.getPresidentialCandidates().then(function(t){l.candidates=t},function(t){}),c.code&&(a.setToken(c.code),n.search("code",null),n.hash("")),function u(){r.getRecentTweets().then(function(t){l.bernie=t.bernie,l.clinton=t.clinton,l.trump=t.trump,l.rubio=t.rubio;var e=100,n=100,a=100,r=100,i=t.bernie/5,s=t.clinton/5,c=t.trump/5,d=t.rubio/5;e+=e*i,n+=n*s,a+=a*c,r+=r*d,document.getElementById("bernie").height=e,document.getElementById("bernie").style.marginTop=175-e/2+"px",document.getElementById("hillary").height=n,document.getElementById("hillary").style.marginTop=175-n/2+"px",document.getElementById("trump").height=a,document.getElementById("trump").style.marginTop=175-a/2+"px",document.getElementById("rubio").height=r,document.getElementById("rubio").style.marginTop=175-r/2+"px",l.busts=!0,l.timeoutHandler=o(u,15e3)},function(t){})}(),t.$on("$destroy",function(){angular.isDefined(l.timeoutHandler)&&(o.cancel(l.timeoutHandler),l.timeoutHandler=void 0)})}t.$inject=["$scope","$state","$location","$timeout","UserFactory","TweetFactory","CandidateFactory","$window"],angular.module("app").controller("HomeController",t)}(),function(){"use strict";function t(t,e,n,o,a,r){var i=this;i.user={},i.data={},i.code={},i.sentCode=!1,i.sentEmail=!1,i.codeValidated=!1,i.wrongCode=!1,i.unregisteredPhone=!1,i.unregisteredEmail=!1,i.user.phoneNumber="",i.user.email="",i.data.email=i.user.email,i.sendCode=function(){console.log("FUUUUUUCK"),i.user.phoneNumber&&e.receiveSMSCode(i.user).then(function(t){i.sentCode=!0,i.code.phoneNumber=i.user.phoneNumber,i.openModal("PasswordSMSModalController")},function(t){}),i.user.email&&t.receiveEmailCode(i.user).then(function(t){i.sentEmail=!0,i.code.email=i.user.email,i.openModal("PasswordEmailModalController")},function(t){})},i.validateCode=function(){e.validateCode(i.code).then(function(t){o.go("Home")})},i.openModal=function(t){var e=r.open({templateUrl:"/templates/partials/passwordValidate.html",size:"md",controller:t+" as vm",resolve:{code:function(){return i.code}}});e.result.then(function(t){},function(){console.log("error")})}}function e(t,e,n,o,a){var r=this;r.code=o,r.user={},t.ok=function(){n.validateEmailCode(r.code).then(function(t){a.go("Home"),e.close()}),r.loading=!0},t.cancel=function(){e.dismiss("cancel")}}function n(t,e,n,o,a){var r=this;r.code=o,r.user={},t.ok=function(){n.validateCode(r.code).then(function(t){a.go("Home"),e.close()}),r.loading=!0},t.cancel=function(){e.dismiss("cancel")}}t.$inject=["EmailFactory","SMSFactory","UserFactory","$state","$stateParams","$uibModal"],e.$inject=["$scope","$uibModalInstance","EmailFactory","code","$state"],n.$inject=["$scope","$uibModalInstance","SMSFactory","code","$state"],angular.module("app").controller("PasswordResetController",t).controller("PasswordEmailModalController",e).controller("PasswordSMSModalController",n)}(),function(){"use strict";function t(){}angular.module("app").controller("ProfileController",t)}(),function(){"use strict";function t(t,e){var n=this;n.donationAmount=20,n.stripeCallback=function(o,a){t.postCharge(a.id,n.donationAmount).then(function(t){swal("Thank you for your donation!","You have been upgraded to a premium account!","success"),e.go("Home")},function(t){swal("Unable to process donation.","Please check your payment information and try again.","error")})}}t.$inject=["StripeFactory","$state"],angular.module("app").controller("StripeController",t)}(),function(){"use strict";function t(t,e,n){var o=e.search();o.code&&(n.setToken(o.code),e.search("code",null))}t.$inject=["$state","$location","UserFactory"],angular.module("app").controller("WelcomeController",t)}(),function(){"use strict";function t(t,e){var n={};return n.getPresidentialCandidates=function(){var n=e.defer();return t.get("/api/v1/candidates/presidential").then(function(t){n.resolve(t.data)},function(t){n.reject()}),n.promise},n.getCandidateById=function(n){var o=e.defer();return t.get("/api/v1/candidates/"+n).then(function(t){o.resolve(t.data)},function(t){o.reject()}),o.promise},n}t.$inject=["$http","$q"],angular.module("app").factory("CandidateFactory",t)}(),function(){"use strict";function t(t,e,n){var o={};return o.deleteComment=function(o){var a=e.defer();return t["delete"]("/api/v1/comments/"+o,{headers:{authorization:"Bearer "+n.localStorage.getItem("token")}}).then(function(t){a.resolve(t.data)},function(t){a.reject()}),a.promise},o.getAllCandidateComments=function(n){var o=e.defer();return t.get("/api/v1/comments/"+n).then(function(t){o.resolve(t.data)},function(t){o.reject()}),o.promise},o.createComment=function(o,a){var r=e.defer();return t.post("/api/v1/comments/"+a,{message:o},{headers:{authorization:"Bearer "+n.localStorage.getItem("token")}}).then(function(t){r.resolve(t.data)},function(t){r.reject()}),r.promise},o.updateComment=function(o,a){var r=e.defer();return t.put("/api/v1/comments/"+a._id,o,{headers:{authorization:"Bearer "+n.localStorage.getItem("token")}}).then(function(t){r.resolve(t.data)},function(t){r.reject()}),r.promise},o}t.$inject=["$http","$q","$window"],angular.module("app").factory("CommentFactory",t)}(),function(){"use strict";function t(t,e){var n={};return n.receiveEmailCode=function(n){var o=e.defer();return t.post("/api/v1/contact/receiveCode",n).then(function(t){o.resolve()},function(t){o.reject()}),o.promise},n.validateEmailCode=function(n){var o=e.defer();return t.post("/api/v1/contact/validate",n).then(function(t){o.resolve()}),o.promise},n.sendMail=function(n){var o=e.defer();return t.post("/api/v1/contact/send",n).then(function(t){o.resolve(t.data)},function(t){o.reject()}),o.promise},n.sendMailCode=function(n){var o=e.defer();return t.post("/api/v1/contact/sendCode",n).then(function(t){o.resolve(t.data)},function(t){o.reject()}),o.promise},n}t.$inject=["$http","$q"],angular.module("app").factory("EmailFactory",t)}(),function(){"use strict";function t(t,e){var n={};return n.receiveSMSCode=function(n){console.log(n);var o=e.defer();return t.post("/api/v1/sms/receiveCode",n).then(function(t){o.resolve()},function(t){o.reject()}),o.promise},n.sendSMS=function(n){var o=e.defer();return t.post("/api/v1/sms/send",n).then(function(t){o.resolve()},function(t){o.reject()}),o.promise},n.validateCode=function(n){var o=e.defer();return t.post("/api/v1/sms/validate",n).then(function(t){o.resolve()}),o.promise},n}t.$inject=["$http","$q"],angular.module("app").factory("SMSFactory",t)}(),function(){"use strict";function t(t,e){var n={};return n}t.$inject=["$http","$q"],angular.module("app").factory("SentimentFactory",t)}(),function(){"use strict";function t(t,e,n,o){var a={};return a.postCharge=function(a,r){var i=t.defer(),s={};return s.email=o.status.email,s.token=a,s.amount=100*r,e.post("api/v1/invoice/charge",s,{headers:{authorization:"Bearer "+n.localStorage.getItem("token")}}).then(function(t){o.status.premiumStatus=!0,i.resolve(t.data)},function(t){i.reject()}),i.promise},a}t.$inject=["$q","$http","$window","UserFactory"],angular.module("app").factory("StripeFactory",t)}(),function(){"use strict";function t(t,e,n){var o={};return o.getRecentTweets=function(){var n=e.defer();return t.get("/api/v1/tweets").then(function(t){n.resolve(t.data)},function(t){n.reject()}),n.promise},o.getCandidateTweets=function(n){var o=e.defer();return t.get("/api/v1/tweets/"+n).then(function(t){o.resolve(t.data)},function(t){o.reject()}),o.promise},o}t.$inject=["$http","$q","$timeout"],angular.module("app").factory("TweetFactory",t)}(),function(){"use strict";function t(t,e,n){var o={};return o.status={},o.register=function(n){var a=t.defer();return e.post("/api/v1/users/register",n).then(function(t){o.setToken(t.data.token),a.resolve(t.data)}),a.promise},o.resetPassword=function(n){var o=t.defer();return e.post("/api/v1/users/resetPassword",n).then(function(t){o.resolve()}),o.promise},o.phoneExists=function(n){var o=t.defer();return e.post("/api/v1/users/registeredPhone",n).then(function(t){o.resolve(t.data)}),o.promise},o.emailExists=function(n){var o=t.defer();return e.post("/api/v1/users/registeredEmail",n).then(function(t){o.resolve(t.data)}),o.promise},o.login=function(n){var a=t.defer();return e.post("/api/v1/users/login",n).then(function(t){o.setToken(t.data.token),a.resolve(t.data)}),a.promise},o.getToken=function(){return n.localStorage.getItem("token")},o.setToken=function(t){n.localStorage.setItem("token",t),o.setUser()},o.removeToken=function(){n.localStorage.removeItem("token"),o.status._id=null,o.status.uuid=null,o.status.premiumStatus=null,o.status.email=null},o.setUser=function(){var t=JSON.parse(atob(o.getToken().split(".")[1]));o.status._id=t._id,o.status.email=t.email,o.status.uuid=t.uuid,o.status.premiumStatus=t.premiumStatus},o.getToken()&&o.setUser(),o}t.$inject=["$q","$http","$window"],angular.module("app").factory("UserFactory",t)}();